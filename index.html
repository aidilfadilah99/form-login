<!DOCTYPE html>
<html>
<head>
  <title>Form Login & Input</title>
  <script>
    let loggedIn = false;

    function loginUser(event) {
      event.preventDefault();
      const id = document.getElementById("id").value;
      const pw = document.getElementById("password").value;

      fetch("https://script.google.com/macros/s/AKfycbzv2rXKRqz3r-ipzQBsPRsrtkJWvwWEHFB6Yc0tkVAq6e--mOWBC6rbA_53YbD3SmJWsA/exec", {
        method: "POST",
        body: new URLSearchParams({
          mode: "login",
          id: id,
          password: pw
        })
      })
      .then(res => res.text())
      .then(res => {
        if (res === "success") {
          loggedIn = true;
          document.getElementById("login-form").style.display = "none";
          document.getElementById("input-form").style.display = "block";
        } else {
          alert("Login gagal!");
        }
      });
    }

    function submitForm(event) {
      event.preventDefault();
      if (!loggedIn) {
        alert("Harus login dulu.");
        return;
      }

      const nama = document.getElementById("nama").value;
      const umur = document.getElementById("umur").value;
      const alamat = document.getElementById("alamat").value;
      const oleh = document.getElementById("oleh").value;

      fetch("https://script.google.com/macros/s/AKfycbzv2rXKRqz3r-ipzQBsPRsrtkJWvwWEHFB6Yc0tkVAq6e--mOWBC6rbA_53YbD3SmJWsA/exec", {
        method: "POST",
        body: new URLSearchParams({
          mode: "submit",
          nama: nama,
          umur: umur,
          alamat: alamat,
          oleh: oleh
        })
      })
      .then(res => res.text())
      .then(res => {
        if (res === "data_saved") {
          alert("Data berhasil disimpan!");
          document.getElementById("input-form").reset();
        } else {
          alert("Gagal menyimpan data.");
        }
      });
    }

    function logout() {
      loggedIn = false;
      document.getElementById("login-form").style.display = "block";
      document.getElementById("input-form").style.display = "none";
    }
  </script>
</head>
<body>
  <h2>Login</h2>
  <form id="login-form" onsubmit="loginUser(event)">
    <input type="text" id="id" placeholder="User ID" required><br>
    <input type="password" id="password" placeholder="Password" required><br>
    <button type="submit">Login</button>
  </form>

  <form id="input-form" onsubmit="submitForm(event)" style="display:none">
    <h2>Input Data</h2>
    <input type="text" id="nama" placeholder="Nama" required><br>
    <input type="number" id="umur" placeholder="Umur" required><br>
    <input type="text" id="alamat" placeholder="Alamat" required><br>
    <input type="text" id="oleh" placeholder="Diinput oleh" required><br>
    <button type="submit">Kirim Data</button>
    <button type="button" onclick="logout()">Logout</button>
  </form>
</body>
</html>
